% This is file JFM2esam.tex
% first release v1.0, 20th October 1996
%       release v1.01, 29th October 1996
%       release v1.1, 25th June 1997
%       release v2.0, 27th July 2004
%       release v3.0, 16th July 2014
%   (based on JFMsampl.tex v1.3 for LaTeX2.09)
% Copyright (C) 1996, 1997, 2014 Cambridge University Press

\documentclass{jfm}
\usepackage{graphicx}  % \graphicspath{{../Figure/}}
\usepackage{epstopdf, epsfig}\epstopdfsetup{ suffix=}
\usepackage[colorlinks = true, citecolor = blue]{hyperref}
\usepackage{amsmath}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\shorttitle{Dynamic Taylor Cone Revisited}
\shortauthor{C. Zhou and S. M. Troian}

\title{Dynamic Taylor Cone Part II: Numeric Scheme}

\author{ Chengzhe Zhou\aff{1}
 \and S. M. Troian\aff{2}   \corresp{\email{stroian@caltech.edu}}} 

\affiliation{\aff{1}Division of Physics, Mathematics and Astronomy, California Institute of Technology,
Pasadena, CA 91125, USA
\aff{2}Department of Applied Physics and Materials Science, 
%Division of Engineering and Applied Science,
California Institute of Technology,
Pasadena, CA 91125, USA}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\input{taylorCone.macro}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{document}
\maketitle
\begin{abstract}
Numeric scheme \citep{Taylor64}
\end{abstract}

\begin{keywords}
electrohydrodynamics, free surface flow, surface singularity \comment{(Authors should
not enter keywords on the manuscript)}
\end{keywords}

\section{Quintic spline}
Given $N$ marker points $\{\vec{x}_0,\dots,\vec{x}_N\}$,
we first compute $(N-1)$ chord lengths $\{h_0,\dots,h_{N-1}\}$
by euclidean norm between adjacent marker points,
\begin{equation}
h_j=\|\vec{x}_{j+1}-\vec{x}_{j}\|\quad\textrm{for}\quad j=0,\dots,N-1
\end{equation}
Then we  introduce $N$ chord coordinates $\{l_0,\dots,l_N\}$ with $l_0=0$ and
\begin{equation}
l_j=\sum_{k=0}^{j-1}h_k\quad\textrm{for}\quad j=1,\dots,N
\end{equation}
Global spline is a collection of local splines $\{\vec{s}^{(0)},\dots,\vec{s}^{(N-1)}\}$
where each $\vec{s}^{(j)}$ is a fifth degree polynomial defined on the interval $l\in[l_j,l_{j+1}]$,
\begin{equation}
\vec{s}^{(j)}(l)=\vec{x}_j+\sum_{k=1}^{5}\vec{c}^{(j)}_k(l-l_j)^k,
\quad\textrm{for}\quad j=0,\dots,N-1
\end{equation}
Continuity between neighboring splines is satisfied up to the fourth derivative,
\begin{equation}
\left.\dd{^{p}\vec{s}^{(j)}}{l^p}\right|_{l_{j+1}}=
\left.\dd{^{p}\vec{s}^{(j+1)}}{l^p}\right|_{l_{j+1}},
\quad\textrm{for}\quad p=0,\dots,4
\end{equation}
The continuity conditions yield five equations
\begin{equation}\left.
\begin{aligned}
\vec{c}^{(j-1)}_3h_{j-1}^3+\vec{c}^{(j-1)}_4h_{j-1}^4+\vec{c}^{(j-1)}_5h_{j-1}^5
&=\vec{x}_j-\vec{x}_{j-1}-\vec{c}^{(j-1)}_1h_{j-1}-\vec{c}^{(j-1)}_2h_{j-1}^2\\
3\vec{c}^{(j-1)}_3h_{j-1}^2+4\vec{c}^{(j-1)}_4h_{j-1}^3+5\vec{c}^{(j-1)}_5h_{j-1}^4
&=-\vec{c}^{(j-1)}_1-2\vec{c}^{(j-1)}_2h_{j-1}+\vec{c}_1^{(j)}\\
6\vec{c}^{(j-1)}_3h_{j-1}+12\vec{c}^{(j-1)}_4h_{j-1}^2+20\vec{c}^{(j-1)}_5h_{j-1}^3
&=-2\vec{c}^{(j-1)}_2+2\vec{c}_2^{(j)}\\
\vec{c}_3^{(j-1)}+4 h_{j-1} \vec{c}_4^{(j-1)}+10 h_{j-1}^2 \vec{c}_5^{(j-1)}
&=\vec{c}_3^{(j)}\\
\vec{c}_4^{(j-1)}+5 h_{j-1} \vec{c}_5^{(j-1)}
&=\vec{c}_4^{(j)}
\end{aligned}\right\}
\end{equation}
We first solve for $\vec{c}^{(j-1)}_3$, $\vec{c}^{(j-1)}_4$ and $\vec{c}^{(j-1)}_5$,
\begin{equation}\label{eq:spline_c3c4c5}\left.
\begin{aligned}
h^3_{j-1}\vec{c}^{(j-1)}_3=
&&-6 h_{j-1} \vec{c}_1^{(j-1)}
&&-3 h_{j-1}^2 \vec{c}_2^{(j-1)}
&&-4 h_{j-1} \vec{c}_1^{(j)}
&&+h_{j-1}^2 \vec{c}_2^{(j)}
&&+10( \vec{x}_j- \vec{x}_{j-1})\\
h^4_{j-1}\vec{c}^{(j-1)}_4=
&&+8 h_{j-1} \vec{c}_1^{(j-1)}
&&+3 h_{j-1}^2 \vec{c}_2^{(j-1)}
&&+7 h_{j-1} \vec{c}_1^{(j)}
&&-2 h_{j-1}^2 \vec{c}_2^{(j)}
&&-15 (\vec{x}_j- \vec{x}_{j-1})\\
h^5_{j-1}\vec{c}^{(j-1)}_5=
&&-3 h_{j-1} \vec{c}_1^{(j-1)}
&&-h_{j-1}^2 \vec{c}_2^{(j-1)}
&&-3 h_{j-1} \vec{c}_1^{(j)}
&&+h_{j-1}^2 \vec{c}_2^{(j)}
&&+6( \vec{x}_j- \vec{x}_{j-1})
\end{aligned}\right\}
\end{equation}
Define $\lambda=h_j/h_{j-1}$. We have $2(N-1)$ equations for $j=1,\dots, N-1$,
\begin{equation}\label{eq:spline_mid}
\left.\begin{aligned}
10\left[+ \lambda^3 \vec{x}_{j-1}- (1+\lambda^3) \vec{x}_j+\vec{x}_{j+1}\right]=
&&4 h_{j} \lambda^2 \vec{c}_1^{(j-1)}
&&+6 h_{j} (\lambda^2-1) \vec{c}_1^{(j)}
&&-4 h_{j} \vec{c}_1^{(j+1)}\\
&&+h_{j}^2 \lambda \vec{c}_2^{(j-1)}
&&-3 h_{j}^2 (1+\lambda) \vec{c}_2^{(j)}
&&+h_{j}^2 \vec{c}_2^{(j+1)}
\\
15 \left[- \lambda^4 \vec{x}_{j-1}+ (\lambda^4-1) \vec{x}_j+\vec{x}_{j+1}\right]=
&&7 h_{j} \lambda^3 \vec{c}_1^{(j-1)}
&&+8 h_{j} (1+\lambda^3) \vec{c}_1^{(j)}
&&+7 h_{j} \vec{c}_1^{(j+1)}\\
&&+2 h_{j}^2 \lambda^2 \vec{c}_2^{(j-1)}
&&+3h_{j}^2 (1- \lambda^2) \vec{c}_2^{(j)}
&&-2 h_{j}^2 \vec{c}_2^{(j+1)}
\end{aligned}\right\}
\end{equation}
for $2(N+1)$ unknowns,
 $\{\vec{c}_1^{(0)},\dots,\vec{c}_1^{(N)}\}$ and  $\{\vec{c}_2^{(0)},\dots,\vec{c}_2^{(N)}\}$.
The imposed boundary conditions at the beginning and end of the global spline
produce four additional equations for
$\{\vec{c}_1^{(0)}, \vec{c}_2^{(0)},\vec{c}_1^{(N)}, \vec{c}_2^{(N)}\}$.
Note we have implicitly introduced a ghost spline $\vec{s}^{(N)}$
which satisfies all continuity conditions with $\vec{s}^{(N-1)}$.
The purpose of $\vec{s}^{(N)}$ is to deal with boundary conditions at the end of spline.

\par In general there are three types of boundary conditions at each end.
Let $x$, $s$ and  ${c}^{(j)}$ be one of the scalar components of vector $\vec{x}_j$,
spline $\vec{s}^{(j)}$ and coefficient $\vec{c}^{(j)}$.
We first consider boundary conditions at $l=l_0$,
\begin{alignat}{3}
\textrm{Even:}\quad&&0&=\dd{s^{(0)}}{l}=\dd{^3s^{(0)}}{l^3}&&\quad\textrm{at}\quad l=l_0\\
\textrm{Odd:}\quad&&0&=s^{(0)}=\dd{^2s^{(0)}}{l^2}=\dd{^4s^{(0)}}{l^4}&&\quad\textrm{at}\quad l=l_0\\
\textrm{Mix:}\quad&&\alpha&=\dd{s^{(0)}}{l},\quad \beta=\dd{^2s^{(0)}}{l^2}&&\quad\textrm{at}\quad l=l_0
\end{alignat}
which lead to two equations,
\begin{subequations}\label{eq:spline_beginbc}
\begin{alignat}{2}
\left.\begin{aligned}
c_1^{(0)}&=0\\
6 h_{0} c_1^{(0)}
+3 h_{0}^2 c_2^{(0)}
+4 h_{0} c_1^{(1)}
-h_{0}^2 c_2^{(1)}
&=-10 x_{0}+10 x_1
\end{aligned}\right\}&&\quad\textrm{Even}\\
\left.\begin{aligned}
-8 h_{0} c_1^{(0)}
-3 h_{0}^2 c_2^{(0)}
-7 h_{0} c_1^{(1)}
+2 h_{0}^2 c_2^{(1)}
&=+15 x_{0}-15 x_1\\
c_2^{(0)}&=0
\end{aligned}\right\}&&\quad\textrm{Odd}\\
\left.\begin{aligned}
c_1^{(0)}&=\alpha\hphantom{\,15 x_{0}-15 x_1}\\
c_2^{(0)}&=\beta/2
\end{aligned}\right\}&&\quad\textrm{Mix}
\end{alignat}
\end{subequations}
We then consider boundary conditions at $l=l_N$,
\begin{alignat}{3}
\textrm{Even:}\quad&&0&=\dd{s^{(N-1)}}{l}=\dd{^3s^{(N-1)}}{l^3}
&&\quad\textrm{at}\quad l=l_N\\
\textrm{Odd:}\quad&&0&=s^{(N-1)}=\dd{^2s^{(N-1)}}{l^2}=\dd{^4s^{(N-1)}}{l^4}
&&\quad\textrm{at}\quad l=l_N\\
\textrm{Mix:}\quad&&\alpha&=\dd{s^{(N-1)}}{l},\quad \beta=\dd{^2s^{(N-1)}}{l^2}
&&\quad\textrm{at}\quad l=l_N
\end{alignat}
which also lead to two equations,
\begin{subequations}\label{eq:spline_endbc}
\begin{alignat}{2}
\left.\begin{aligned}
c_1^{(N)}&=0\\
-4 h_{N-1} {c}_1^{(N-1)}
-h_{N-1}^2 {c}_2^{(N-1)}
-6 h_{N-1} {c}_1^{(N)}
+3 h_{N-1}^2 {c}_2^{(N)}
&=10 {x}_{N-1}-10 {x}_N
\end{aligned}\right\}&&\quad\textrm{Even}\\
\left.\begin{aligned}
-7 h_{N-1} {c}_1^{(N-1)}
-2 h_{N-1}^2 {c}_2^{(N-1)}
-8 h_{N-1} {c}_1^{(N)}
+3 h_{N-1}^2 {c}_2^{(N)}
&=15 {x}_{N-1}-15 {x}_N\\
c_2^{(N)}&=0
\end{aligned}\right\}&&\quad\textrm{Odd}\\
\left.\begin{aligned}
c_1^{(N)}&=\alpha\hphantom{\!\!\!\!15 {x}_{N-1}-15 {x}_N}\\
c_2^{(N)}&=\beta/2
\end{aligned}\right\}&&\quad\textrm{Mix}
\end{alignat}
\end{subequations}
If we arrange the unknowns into a vector,
\begin{equation}
\big[c_1^{(0)},c_2^{(0)},\dots,c_1^{(j)},c_2^{(j)},\dots,c_1^{(N)},c_2^{(N)}\big]
\end{equation}
equations (\ref{eq:spline_mid}) with one of (\ref{eq:spline_beginbc})
and one of (\ref{eq:spline_endbc}) result in a $2(N+1)$-by-$2(N+1)$ system of linear equations,
which corresponds to a banded diagonal sparse matrix with at most 6 non-zero elements in each row.
The rest coefficients $\vec{c}_3^{(j)}$, $\vec{c}_4^{(j)}$ and $\vec{c}_5^{(j)}$
can be reconstruct using equation (\ref{eq:spline_c3c4c5}).

\par It is convenient to re-parametrize each local spline with a new variable $t\in[0,1]$,
\begin{equation}
\vec{s}^{(j)}(t)=\vec{x}_j+\sum_{k=1}^{5}\vec{c}^{(j)}_k  t ^k,
\quad\textrm{for}\quad j=0,\dots,N-1
\end{equation}
by redefining $\vec{c}^{(j)}_k\to \vec{c}^{(j)}_kh_j^k$.
We can construct Lagrange interpolations along the arc-length of the global spline
by the local arc-length $L_j$ and its local fraction $\xi$,
\begin{equation}
L_j = \int_{0}^1\dot{\vec{s}}^{(j)}\,\mathrm{d}t',\quad
\xi(t) =\frac{1}{L_j} \int_{0}^t\dot{\vec{s}}^{(j)}\,\mathrm{d}t',\quad
\end{equation}
Convention for normal vector $\vec{n}$,
\begin{equation}
\vec{n}=\frac{(-\dot{z},\dot{r})}{\|\dot{\vec{s}}\|}
\end{equation}

\section{Numerical integration and approximation}
Standard $m$-point Gauss-Legendre quadrature,
\begin{equation}
\int_0^1 f(t)\,\mathrm{d}t\approx \sum_{k=1}^{m}w_k f(x_k),\quad
\int_a^b f(t)\,\mathrm{d}t\Rightarrow
%\int_a^b =\sum_{k=1}^{m}(b-a)w_k f(a+(b-a)x_k),
\begin{aligned}
x_k&\to a+(b-a)x_k\\ w_k&\to (b-a)w_k
\end{aligned}
\end{equation}
Logarithmic-weighted Gauss quadrature,
\begin{equation}
\int_0^1 f(t) \ln t \,\mathrm{d}t\approx -\sum_{k=1}^{m}w_k^\mathrm{log} f(x_k),\quad
\int_0^1 f(t) \ln (1-t) \,\mathrm{d}t\approx -\sum_{k=1}^{m}w_k^\mathrm{log} f(1-x_k)
\end{equation}
When logarithmic singularity $\tau\in (0,1)$,
\begin{align*}
&\int_0^1 f(t) \ln |t-\tau|\,\mathrm{d}t 
=\int_0^\tau f(t) \ln (\tau - t)\,\mathrm{d}t+\int_\tau^1 f(t) \ln (t-\tau)\,\mathrm{d}t\\
=&\,\tau\int_0^1 f(\tau s) \ln (\tau - \tau s)\,\mathrm{d}s
+(1-\tau) \int_0^1 f(\tau + (1-\tau) s) \ln ( (1-\tau) s)\,\mathrm{d}s\\
=&\,\tau\int_0^1 f(\tau s) \ln (1 - s)\,\mathrm{d} s
+(1-\tau) \int_0^1 f(\tau + (1-\tau) s) \ln s\,\mathrm{d}s\\
&\quad+\tau\ln\tau\int_0^1 f(\tau s) \,\mathrm{d} s
+(1-\tau)\ln (1-\tau) \int_0^1 f(\tau + (1-\tau) s) \,\mathrm{d}s
\end{align*}
Logarithmic-weighted Gauss quadrature for singularity $\tau\in (0,1)$,
\begin{equation}\int_0^1 f(t) \ln |t-\tau|\,\mathrm{d}t 
\approx\left\{ 
\begin{aligned}
\tau\ln\tau &\sum_{k=1}^m w_k f\left[x_k\right] \\
+ (1- \tau)\ln(1-\tau) &\sum_{k=1}^m w_k f\left[\tau + (1-\tau)x_k\right]\\
- \tau &\sum_{k=1}^m w_k^\mathrm{log} f\left[\tau(1 -x_k^\mathrm{log})\right]\\
- (1- \tau) &\sum_{k=1}^m w_k^\mathrm{log} f\left[\tau + (1-\tau)x_k^\mathrm{log}\right]
\end{aligned}\right.
\end{equation}

Elliptic integral of the first and second kind,
\begin{equation}
K(m)=\int_0^{\pi/2}\frac{\mathrm{d}\theta}{\sqrt{1-m \sin^2 \theta}},\quad
E(m)=\int_0^{\pi/2}\sqrt{1-m \sin^2 \theta}\,\mathrm{d}\theta
\end{equation}
Elliptic integral of the first and second kind,
\begin{equation}
K(m)\approx P_K(m) -\ln(1-m) Q_K(m),\quad
E(m)\approx P_E(m) -\ln(1-m) Q_E(m) 
\end{equation}
where $P_K$, $P_E$, $Q_K$, $Q_E$ are tenth order polynomials.
Associate Legendre polynomial of $1/2$ order can be conveniently expressed as,
\begin{equation}
P_{1/2}(x)=\frac{2}{\pi}\left\{2 E\left(\frac{1-x}{2}\right)-K\left(\frac{1-x}{2}\right)\right\}
\end{equation}

\section{Axisymmetric boundary integral}
Axisymmetric Green's function $G(\vec{\eta}';\vec{\eta})$,
\begin{align}
G(\vec{\eta}';\vec{\eta})&=\frac{1}{\pi\sqrt{a+b}}K(m)\\
\pd{G(\vec{\eta}';\vec{\eta})}{\vec{n}}&=
\frac{1}{\pi r\sqrt{a+b}}\bigg\{
\left[\frac{n_r}{2}+\frac{\vec{n}\cdot(\vec{x}'-\vec{x})}{\|\vec{x}'-\vec{x}\|^2}r\right]E(m)
-\frac{n_r}{2}K(m)\bigg\}
\end{align}
Auxiliary variables,
\begin{equation}
a=r'^2+r^2+(z'-z)^2,\quad b = 2 r' r,\quad m =\frac{2 b}{a+b}
\end{equation}
Note $\eta\to\eta'$ implies $m\to 1$.
Axisymmetric boundary integral equation,
\begin{equation}
\frac{\beta(\vec{\eta}')}{2\pi}\phi(\vec{\eta}')=\int_{\gamma}
\Big\{
G(\vec{\eta}';\vec{\eta})\pd{\phi}{\vec{n}}(\vec{\eta})-
\phi(\vec{\eta})\pd{G(\vec{\eta}';\vec{\eta})}{\vec{n}}(\vec{\eta})
\Big\}
 r \,\mathrm{d}\gamma(\vec{\eta})
\end{equation}
Lagrange interpolation along arc-length,
\begin{equation}
\phi(\vec{\eta})\approx\sum_e \sum_k p_{e_k}\mathcal{N}^{(e)}_k(\xi),\quad
\pd{\phi}{\vec{n}}(\vec{\eta})\approx\sum_e \sum_kq_{e_k}\mathcal{N}^{(e)}_k(\xi)
\end{equation}
where $\mathcal{N}_k$ is the Lagrange basis of the local fractional arc-length variable $\xi$,
\begin{equation}
\mathcal{N}_0=(1 - \xi) (1 - 2\xi),\quad
\mathcal{N}_1=4 \xi (1 - \xi) ,\quad
\mathcal{N}_2=\xi (2 \xi- 1)
\end{equation}
\subsection{Single-layer integral}
Single-layer integral reduces to a summation of local integrals over local arc $\gamma_e$ of element $e$,
\begin{align}
\nonumber\int_{\gamma}G(\vec{\eta}';\vec{\eta})
\pd{\phi}{\vec{n}}(\vec{\eta}) r \,\mathrm{d}\gamma(\vec{\eta})
&\approx\sum_e \sum_k q_{e_k}
\int_{\gamma_e}G(\vec{\eta}';\vec{\eta})\mathcal{N}^{(e)}_k(\xi) r \,\mathrm{d}\gamma(\vec{\eta})\\
&=\sum_e \sum_k q_{e_k}
\int_0^1\frac{ r J }{\pi \sqrt{a+b}}\mathcal{N}^{(e)}_k(\xi)K(m)\,\mathrm{d}t
\end{align}
When singularity $\vec{\eta}'\in \gamma_e$ is located at $t=\tau \in[0,1]$,
\begin{align*}
\int_0^1\frac{ r J }{\pi \sqrt{a+b}}\mathcal{N}^{(e)}_kK(m)\,\mathrm{d}t
=&\int_0^1\frac{ r J }{\pi \sqrt{a+b}}\mathcal{N}^{(e)}_k
\left[P_K -Q_K\ln\frac{1-m}{(t-\tau)^2}-2 Q_K\ln |t-\tau| \right]\,\mathrm{d}t
\end{align*}
Introduce helper functions,
\begin{align}
f_K^\mathrm{single}(t)&= \frac{ r J }{\pi \sqrt{a+b}} \\
R_{K/E}(m,\tau)&= P_{K/E}(m) -Q_{K/E}(m) \ln\frac{1-m}{(t-\tau)^2}
\end{align}
If we define integrand $I^{(o)}$ for source location $\vec{\eta}'$ outside of $\gamma_e$
and $I^{(i)}$ for $\vec{\eta}'$ interior to $\gamma_e$,
\begin{align}
I^{(o)}(t) &=  f_K^\mathrm{single}(t) K(m)\mathcal{N}^{(e)}_k(\xi)\\
I^{(i)}(t,\tau) &= f_K^\mathrm{single}(t)R_K(m,\tau)\mathcal{N}^{(e)}_k(\xi)\\
I^{(i)}_\mathrm{log}(t) &=-2 f_K^\mathrm{single} (t)Q_K(m) \mathcal{N}^{(e)}_k(\xi)
\end{align}
then the local single-layer integral can be compactly represented
with a regular part and a logarithmic-singular one,
\begin{align}
\vec{\eta}' \not\in \gamma_e:\,\,\textrm{compute}&\int_0^1I^{(o)}(t)\,\mathrm{d}t\\
\vec{\eta}' \textrm{ at } t= 0:\,\,\textrm{compute}&\int_0^1I^{(i)}(t,0)\,\mathrm{d}t+
\int_0^1I^{(i)}_\mathrm{log}(t)\ln t\,\mathrm{d}t\\
\vec{\eta}' \textrm{ at } t= \tau:\,\,\textrm{compute}&\int_0^1I^{(i)}(t,\tau)\,\mathrm{d}t+
\int_0^1I^{(i)}_\mathrm{log}(t)\ln|\tau-t|\,\mathrm{d}t\\
\vec{\eta}' \textrm{ at } t= 1:\,\,\textrm{compute}&\int_0^1I^{(i)}(t,1)\,\mathrm{d}t+
\int_0^1I^{(i)}_\mathrm{log}(t)\ln(1-t)\,\mathrm{d}t
\end{align}


\subsection{Double-layer integral}
Similar to singular-layer integral, double-layer integral reduces to a summation of local integrals over local arc $\gamma_e$ of element $e$,
\begin{align}
&\nonumber\int_{\gamma}\pd{G(\vec{\eta}';\vec{\eta})}{\vec{n}}\phi(\vec{\eta}) r \,\mathrm{d}\gamma(\vec{\eta})
\approx\sum_e \sum_k p_{e_k}
\int_{\gamma_e}\pd{G(\vec{\eta}';\vec{\eta})}{\vec{n}}\mathcal{N}^{(e)}_k(\xi) r \,\mathrm{d}\gamma(\vec{\eta})\\
=&\nonumber\,\sum_e \sum_k p_{e_k}
\int_0^1\mathcal{N}^{(e)}_k(\xi)
\frac{J}{\pi \sqrt{a+b}}\bigg\{
\left[\frac{n_r}{2}+\frac{\vec{n}\cdot(\vec{x}'-\vec{x})}{\|\vec{x}'-\vec{x}\|^2}r\right]E(m)
-\frac{n_r}{2}K(m)\bigg\}
\,\mathrm{d}t\\
=&\,\sum_e \sum_k p_{e_k}
\int_0^1
\frac{\mathcal{N}^{(e)}_k(\xi)}{\pi \sqrt{a+b}}\bigg\{
\left[\frac{\dot{r}(z'-z)-\dot{z}(r'-r)}{(r'-r)^2+(z'-z)^2}r
-\frac{\dot{z}}{2}\right]E(m)
+\frac{\dot{z}}{2}K(m)\bigg\}
\,\mathrm{d}t
\end{align}
Technically we don't need to treat integrand involving elliptic integral of the second kind $E(m)$.
However, convergence rate of standard Gauss-Legendre quadrature  depends magnitude of derivatives.
\begin{equation}
f_E^\mathrm{double}=\frac{1}{\pi \sqrt{a+b}}
\left[\frac{\dot{r}(z'-z)-\dot{z}(r'-r)}{a-b}r
-\frac{\dot{z}}{2}\right],\quad
f_K^\mathrm{double}=\frac{1}{\pi \sqrt{a+b}}
\frac{\dot{z}}{2}
\end{equation}
If we define integrand $I^{(o)}$ for source location $\vec{\eta}'$ outside of $\gamma_e$
and $I^{(i)}$ for $\vec{\eta}'$ interior to $\gamma_e$,
\begin{align}
I^{(o)}(t) &= \left[ f_E^\mathrm{double} E(m)+f_K^\mathrm{double} K(m)\right]\mathcal{N}^{(e)}_k(\xi)\\
I^{(i)}(t,\tau) &= \left[f_E^\mathrm{double}R_E(m,\tau)+ f_K^\mathrm{double}R_K(m,\tau)\right]\mathcal{N}^{(e)}_k(\xi)\\
I^{(i)}_\mathrm{log}(t) &=-2 f_E^\mathrm{double}Q_E(m) -2 f_K^\mathrm{double}Q_K(m) 
\end{align}
When $\vec{\eta'}$ is located the symmetry axis where $r'=0$,
we can simplify the elliptic integrals,
\begin{align}
\int_{\gamma}G(\vec{\eta}';\vec{\eta})
\pd{\phi}{\vec{n}}(\vec{\eta}) r \,\mathrm{d}\gamma(\vec{\eta})
&\approx\sum_e \sum_k q_{e_k}
\int_0^1\mathcal{N}^{(e)}_k(\xi)\frac{   J }{
2 \sqrt{1+\left[(z-z')/r\right]^2}}\,\mathrm{d}t\\
\int_{\gamma}\pd{G(\vec{\eta}';\vec{\eta})}{\vec{n}}\phi(\vec{\eta}) r \,\mathrm{d}\gamma(\vec{\eta})
&\approx\sum_e \sum_k p_{e_k}
\int_0^1\mathcal{N}^{(e)}_k(\xi) \frac{  
\dot{z}/r+\dot{r}(z-z')/r^2
}{
2\big\{1+[(z-z')/r]^2\big\}^{3/2}
}\,\mathrm{d}t
\end{align}
The above integrands have well-definite limit as $\vec{\eta}\to\vec{\eta}'$
as long as $\ddot{z}/\dot{r}$ at $r=0$ is finite.

\subsection{Assembly}
\begin{table}
  \begin{center}
\def~{\hphantom{0}}
  \begin{tabular}{rl|r}
Element order & $o$\\
Number of elements & $n$\\
Number of nodes & $ n \times o +1$\\
Nodal index of source point & $ i$\\
Elemental index of receiving point & $ j$\\
Local node index & $k$ & $0\le k \le o$\\
Indices of elements $\ni$ $i$-th node if $i \textrm{ mod }  o =0$
& $ \lfloor i / o\rfloor-1$, $ \lfloor i / o\rfloor$& check $ 0\le$ id $\le n-1$\\
Indices of elements $\ni$  $i$-th node  if $i \textrm{ mod }  o \neq 0$
& $ \lfloor i / o\rfloor-1$& check $ 0\le$ id $\le n-1$\\

Nodal indices of $j$-th element  & $j \times o +  k$ & $0\le k \le o$\\
  \end{tabular}
  \caption{Indices}
  \label{tab:kd}
  \end{center}
\end{table}

















\bibliographystyle{jfm}
% Note the spaces between the initials
\bibliography{taylorCone}

\end{document}
